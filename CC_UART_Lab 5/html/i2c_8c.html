<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CC_UART_Lab: src/Source_Files/i2c.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CC_UART_Lab
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2855980263c52be09af3085e80bd06a7.html">Source_Files</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">i2c.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>I2C.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;i2c.h&quot;</code><br />
<code>#include &quot;em_cmu.h&quot;</code><br />
<code>#include &quot;em_assert.h&quot;</code><br />
<code>#include &quot;cmu.h&quot;</code><br />
<code>#include &quot;gpio.h&quot;</code><br />
<code>#include &quot;letimer.h&quot;</code><br />
<code>#include &quot;brd_config.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa10f470e996d0f51210d24f442d25e1e"><td class="memItemLeft" align="right" valign="top"><a id="aa10f470e996d0f51210d24f442d25e1e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>WRITE</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:aa10f470e996d0f51210d24f442d25e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada74e7db007a68e763f20c17f2985356"><td class="memItemLeft" align="right" valign="top"><a id="ada74e7db007a68e763f20c17f2985356"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>READ</b>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ada74e7db007a68e763f20c17f2985356"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd501191443ae27fa7ab059461676249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#afd501191443ae27fa7ab059461676249">i2c_open</a> (I2C_TypeDef *i2c, <a class="el" href="struct_i2_c___o_p_e_n___s_t_r_u_c_t.html">I2C_OPEN_STRUCT</a> *i2c_setup)</td></tr>
<tr class="memdesc:afd501191443ae27fa7ab059461676249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the I2C.  <a href="i2c_8c.html#afd501191443ae27fa7ab059461676249">More...</a><br /></td></tr>
<tr class="separator:afd501191443ae27fa7ab059461676249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad392da40fbc730b1cb2562da0b0a4dcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#ad392da40fbc730b1cb2562da0b0a4dcb">i2c_bus_reset</a> (I2C_TypeDef *i2c)</td></tr>
<tr class="memdesc:ad392da40fbc730b1cb2562da0b0a4dcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the Bus.  <a href="i2c_8c.html#ad392da40fbc730b1cb2562da0b0a4dcb">More...</a><br /></td></tr>
<tr class="separator:ad392da40fbc730b1cb2562da0b0a4dcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a358fb9e907e3fe53c638b2c6cdf8ff92"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#a358fb9e907e3fe53c638b2c6cdf8ff92">i2c_start</a> (I2C_TypeDef *i2c, uint32_t address_slave, uint32_t command, uint32_t *data_, uint32_t callback)</td></tr>
<tr class="memdesc:a358fb9e907e3fe53c638b2c6cdf8ff92"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the I2C.  <a href="i2c_8c.html#a358fb9e907e3fe53c638b2c6cdf8ff92">More...</a><br /></td></tr>
<tr class="separator:a358fb9e907e3fe53c638b2c6cdf8ff92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a906df0c8802c3aac9ccbb74b11716920"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#a906df0c8802c3aac9ccbb74b11716920">I2C0_IRQHandler</a> ()</td></tr>
<tr class="memdesc:a906df0c8802c3aac9ccbb74b11716920"><td class="mdescLeft">&#160;</td><td class="mdescRight">I2C0 Interrupt Handler.  <a href="i2c_8c.html#a906df0c8802c3aac9ccbb74b11716920">More...</a><br /></td></tr>
<tr class="separator:a906df0c8802c3aac9ccbb74b11716920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e0ce3354daaf3dc2912dd9e7b70260d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="i2c_8c.html#a6e0ce3354daaf3dc2912dd9e7b70260d">I2C1_IRQHandler</a> ()</td></tr>
<tr class="memdesc:a6e0ce3354daaf3dc2912dd9e7b70260d"><td class="mdescLeft">&#160;</td><td class="mdescRight">I2C1 Interrupt Handler.  <a href="i2c_8c.html#a6e0ce3354daaf3dc2912dd9e7b70260d">More...</a><br /></td></tr>
<tr class="separator:a6e0ce3354daaf3dc2912dd9e7b70260d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>I2C. </p>
<dl class="section author"><dt>Author</dt><dd>Case Chrisbacher </dd></dl>
<dl class="section date"><dt>Date</dt><dd>March 14th, 2021 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a906df0c8802c3aac9ccbb74b11716920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a906df0c8802c3aac9ccbb74b11716920">&#9670;&nbsp;</a></span>I2C0_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I2C0_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I2C0 Interrupt Handler. </p>
<p>Consisting of a bunch of if statements, if an interrupt is triggered it enters the if statement and calls the local function for that interrupt</p>
<dl class="section note"><dt>Note</dt><dd>Separate Handler called if I2C1 is enabled </dd></dl>

</div>
</div>
<a id="a6e0ce3354daaf3dc2912dd9e7b70260d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e0ce3354daaf3dc2912dd9e7b70260d">&#9670;&nbsp;</a></span>I2C1_IRQHandler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void I2C1_IRQHandler </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>I2C1 Interrupt Handler. </p>
<p>Consisting of a bunch of if statements, if an interrupt is triggered it enters the if statement and calls the local function for that interrupt</p>
<dl class="section note"><dt>Note</dt><dd>Separate Handler called if I2C0 is enabled </dd></dl>

</div>
</div>
<a id="ad392da40fbc730b1cb2562da0b0a4dcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad392da40fbc730b1cb2562da0b0a4dcb">&#9670;&nbsp;</a></span>i2c_bus_reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_bus_reset </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>i2c</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the Bus. </p>
<p>This function resets the I2C state machine of the Pearl Gecko, along with the I2C state machines of the external device connected</p>
<dl class="section note"><dt>Note</dt><dd>For this lab the SI7021 I2C state machine peripherals are being reset</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*i2c</td><td>Pointer to i2c peripheral. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afd501191443ae27fa7ab059461676249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd501191443ae27fa7ab059461676249">&#9670;&nbsp;</a></span>i2c_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_open </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>i2c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_i2_c___o_p_e_n___s_t_r_u_c_t.html">I2C_OPEN_STRUCT</a> *&#160;</td>
          <td class="paramname"><em>i2c_setup</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts the I2C. </p>
<p>This function goes through all of the steps to start the I2C. First it enables the cock to the correct I2C peripheral. Then there is a test to verify proper I2C clock operation. Then a struct is initialized to provide a base address to configure the I2C. The initialize function is called and all the pins and ports for the are routed. The function then resets the bus, enables the interrupts, and enables the interrupts at the CPU level with NVIC_Enable</p>
<dl class="section note"><dt>Note</dt><dd>Function uses if/ else statements to allow use of both I2C0 and I2C1</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*i2c</td><td>Pointer to i2c peripheral.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*i2c_setup</td><td>Pointer to struct used to initialize local struct and then initialize the I2C. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a358fb9e907e3fe53c638b2c6cdf8ff92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a358fb9e907e3fe53c638b2c6cdf8ff92">&#9670;&nbsp;</a></span>i2c_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void i2c_start </td>
          <td>(</td>
          <td class="paramtype">I2C_TypeDef *&#160;</td>
          <td class="paramname"><em>i2c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>address_slave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>data_</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts the I2C. </p>
<p>Function initializes static struct with input arguments and then begins the interrupt driven state machine. It also sets the first state and performs the initialization steps</p>
<dl class="section note"><dt>Note</dt><dd>Write is defined as false</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*i2c</td><td>Pointer to i2c peripheral.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">address_slave</td><td>Address of the device which the Pearl Gecko controlling.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">command</td><td>Command to be sent to the slave.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*data</td><td>Static variable declared in external file, used to keep the value being measured by slave, sent back to the master</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">callback</td><td>Call back for the scheduler created for the I2C. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
